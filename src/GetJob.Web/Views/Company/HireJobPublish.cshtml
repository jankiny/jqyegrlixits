@{
    Layout = "_Company";
}

@model JobViewModel
<form asp-controller="Company" asp-action="HireJobPublish" method="post">
    <input type="hidden" asp-for="CompanyId" value="@User.FindFirst("CompanyId").Value"/>
    <div class="form-group row">
        <label class="col-sm-2 col-form-label" asp-for="Name"></label>
        <div class="col-sm-10">
            <input class="form-control" class="col-sm-10" asp-for="Name"/>
        </div>
    </div>
    <div class="form-group row">
        <label class="col-sm-2 col-form-label" asp-for="JobCharacterId"></label>
        <div class="col-sm-10">
            <select class="form-control" asp-for="JobCharacterId" asp-items="ViewBag.JobCharacters">
                <option value="">-- 选择招聘类型 --</option>
            </select>
        </div>
    </div>
    <div class="form-group row">
        <label class="col-sm-2 col-form-label" asp-for="JobKindId"></label>
        <div class="col-sm-5">
            <select class="form-control" id="FirstKind" onchange="PopulateSecondKinds()" asp-for="JobFirstKindId" asp-items="ViewBag.JobFirstKinds">
                <option value="">-- 选择岗位大类 --</option>
            </select>
        </div>
        <div class="col-sm-5">
            <select class="form-control" id="SecondKind" asp-for="JobKindId">
                <option value="">-- 选择岗位类别 --</option>
            </select>
        </div>
    </div>
    <div class="form-group row">
        <label class="col-sm-2 col-form-label" asp-for="JobPayId"></label>
        <div class="col-sm-10">
            <select class="form-control" asp-for="JobPayId" asp-items="ViewBag.JobPays">
                <option value="">-- 选择薪水 --</option>
            </select>
        </div>
    </div>
    <div class="form-group row">
        <label class="col-sm-2 col-form-label" asp-for="Description"></label>
        <div class="col-sm-10">
            <textarea class="form-control" asp-for="Description" rows="10"></textarea>
        </div>
    </div>
    <div class="form-group row justify-content-end">
        <button type="submit" class="btn btn-primary px-4">添加</button>
    </div>
</form>
<script>
    function PopulateSecondKinds() {
        var firstKindId = $('#FirstKind').val();
        $.ajax({
            url: '/Company/PopulateSecondKinds',
            type: "GET",
            dataType: "JSON",
            data: { firstKindId: firstKindId },
            success: function(kinds) {
                $("#SecondKind").html("");
                $.each(kinds,
                    function(i, kind) {
                        console.log(kind);
                        $("#SecondKind").append($('<option></option>').val(kind.jobKindId).html(kind.text));
                    });
            }
        });
    }
</script>